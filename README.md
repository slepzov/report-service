# Сервис генерации отчетов

## Описание 
Скрипт-клиент отправляет сообщения на генерацию отчетов в RabbitMQ в очередь task_report. Сервис report-service получает сообщения из данной очереди, проверяет наличие в кеше данных по каждому телефону из списка в присланной задаче.
Если данные по телефону не найдены в кэше или истек ttl, то затем для всех таких телефонов данные берутся из data.json, обрабатываются, записываются в кэш и дополнительный файл. При перезапуске сервиса кэш восстанавливаеися из данного файла.
Для кэширования данных используется словарь python. После генерации отправляется сообщение с отчетом в RabbitMQ в очередь ready_report.

## Как запустить:

1. Склонируйте репозиторий на свой ПК
2. Поместите файл data.json в директорию report-service/src/data/ и дать файлу права на чтение `chmod +r report-service/src/data/data.json`
3. Находясь в директории report-service/ выполните команду `docker compose up` 
4. При успешном запуске в консоле появится сообщение "event": "Consumer connected and ready to consume messages."
5. Для работы скрипт-клиента из директории report-service выполните команду `poetry install`, затем `poetry shell`
6. В скрипте report-service/src/scripts/producer.py можно в массиве MESSAGES указать дополнительные входные данные для отправки сообщений в RabbitMQ
7. Находясь в директории report-service/ выполните команду `python3 src/scripts/producer.py` для отправки сообщений с запросами на генерацию отчетов
8. Проверить сообщения с готовыми отчетами можно в RabbitMQ, перейдя в браузере по адресу http://localhost:15672/, логин/пароль: guest/guest 
